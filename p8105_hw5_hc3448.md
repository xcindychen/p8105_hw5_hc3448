p8105_hw5_hc3448
================
HsiYu Chen
2024-11-13

### Problem 1

``` r
bday_sim  = function(n){
  bday = sample (1:365, size = n, replace = TRUE)
  duplicate = length(unique(bday)) <n
  return(duplicate)
}
```

``` r
sim_res = 
  expand_grid(
    n = 2:50,
    iter = 1:10000
  ) |>
  mutate(res = map_lgl(n, bday_sim)) |>
  group_by(n) |>
  summarize(prob = mean(res))
```

``` r
sim_res |>
  ggplot(aes(x=n, y=prob)) +
  geom_line() +
  labs(
    x = "Group Size",           
    y = "Probability",        
    title = "Probability of shared birthday by group size" 
  )
```

<img src="p8105_hw5_hc3448_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

When the group size increases, the probability that at least two people
in the group will share a birthday also increases. When thereâ€™s around
25 people in the group, there is higher than 50% of the probability that
there are at least two people sharing a birthday.

### Problem 2

``` r
n = 30
sigma = 5
mu_list = 0:6
alpha = 0.05
n_dataset = 5000
```

``` r
sim_t_test = function(mu){
  x = rnorm(n, mean = mu, sd = sigma)
  test_result = broom::tidy(t.test(x, mu = 0))
  tibble(
    estimate = test_result[["estimate"]],
    p_value = test_result[["p.value"]]
  )
}

sim_result = 
  expand_grid(
    mu = mu_list,
    iteration = 1: n_dataset
  ) |>
  mutate(
    result_df = map(mu, sim_t_test)
  ) |>
  unnest(result_df)

power_result = 
  sim_result |>
  group_by(mu) |>
  summarize(power = mean(p_value < alpha))
```

``` r
power_result |>
  ggplot(aes(x = mu, y = power)) +
  geom_line() +
  labs(
    x = "True mean",           
    y = "Power",        
    title = "Power of one sample t-test by true mean" 
  ) 
```

<img src="p8105_hw5_hc3448_files/figure-gfm/unnamed-chunk-6-1.png" width="90%" />

The graph showed that when the true mean increases, higher proportion of
times the null are rejected. It suggests that the probability of
rjecting the null hypothesis is higher when the effect size is bigger.

### Problem 3
